function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"5WMv":function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n("mrSG"),r=n("XNiG"),s=n("fXoL"),a=n("rdAd"),o=n("bTqV"),c=n("NFeN"),l=n("ofXK");function u(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",8),s.Wb(1,"img",9,10),s.ec("error",(function(){s.Cc(n);var e=s.Ac(2);return s.ic(2).imgError(e)})),s.Vb(),s.Wb(3,"button",11),s.ec("click",(function(){s.Cc(n);var e=t.$implicit;return s.ic(2).removeFromImages(e.name)})),s.Wb(4,"mat-icon",12),s.Lc(5,"delete_sweep"),s.Vb(),s.Vb(),s.Vb()}if(2&e){var i=t.$implicit;s.Db(1),s.pc("src",i.image,s.Ec)}}function f(e,t){if(1&e&&(s.Ub(0,6),s.Jc(1,u,6,1,"div",7),s.Tb()),2&e){var n=s.ic();s.Db(1),s.pc("ngForOf",n.Images)}}function m(e,t){if(1&e){var n=s.Xb();s.Wb(0,"img",9,10),s.ec("error",(function(){s.Cc(n);var e=s.Ac(1);return s.ic().imgError(e)})),s.Vb(),s.Wb(2,"button",11),s.ec("click",(function(){s.Cc(n);var e=s.ic();return e.remove(e.oneImage)})),s.Wb(3,"mat-icon",12),s.Lc(4,"delete_sweep"),s.Vb(),s.Vb()}if(2&e){var i=s.ic();s.pc("src",i.oneImage,s.Ec)}}var h=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.filesService=t,this.url=n,this.listOfNames=[],this.imagesToShow=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.folderToSaveInServer="folder",this.multiple=!1,this.oneImage="assets/404.jpg",this.Images=[],this.propertyOfParent=new r.a,this.eventSubmitToParent=new r.a,this.eventSubmitFromParent=new r.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.propertyOfParent.subscribe((function(t){if(t){var n=t.split(";");if(n.pop(),e.listOfNames=n,e.listToDelete=[],console.log(n),e.multiple)n.forEach((function(t,n){var i=t;if(null!==i&&i.startsWith("http"))e.Images[n]={name:i,image:i};else if(i){var r="".concat(e.url,"/").concat(e.folderToSaveInServer.replace("_","/"),"/").concat(i);e.Images[n]={name:r,image:r}}else e.Images[n]={name:"assets/404.jpg",image:"assets/404.jpg"}}));else{var i=0!==n.length?n[0]:null;e.oneImage=null!==i&&i.startsWith("http")?i:i?"".concat(e.url,"/").concat(e.folderToSaveInServer,"/").concat(i):"assets/404.jpg"}}})),this.eventSubmitFromParent.subscribe((function(t){return Object(i.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.submit(t);case 2:case"end":return e.stop()}}),e,this)})))}))}},{key:"upload",value:function(e){var t=this;if(this.multiple)for(var n=0;n<e.length;n++){var i=e.item(n);this.listOfNames.push(this.setFileName(i)),this.sendPropertyOfParent(),this.files.push(i),this.files.forEach((function(e,n){var i=new FileReader;i.onload=function(){-1===t.Images.findIndex((function(n){return t.setFileName(e).includes(n.name)}))&&t.Images.push({name:t.setFileName(e),image:i.result.toString()})},i.readAsDataURL(e)}))}else{var r=e.item(0);this.listOfNames=[],this.listOfNames.push(this.setFileName(r)),this.sendPropertyOfParent(),this.files=[],this.files.push(r),this.handleFileInput(r)}}},{key:"fileToImageFrom",value:function(){}},{key:"handleFileInput",value:function(e){var t=this,n=new FileReader;n.onload=function(){return t.oneImage=n.result.toString()},n.readAsDataURL(e)}},{key:"imgError",value:function(e){e.src="assets/404.jpg"}},{key:"setIcon",value:function(e){var t=e.lastIndexOf("."),n=e.substring(t+1);return"pdf"===n||"pdf;"===n?"assets/svg/pdf.svg":"assets/svg/word.svg"}},{key:"removeFromImages",value:function(e){var t=this.Images.findIndex((function(t){return e.includes(t.name)}));this.Images.splice(t,1);var n=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[n]),-1!==n&&(this.listOfNames.splice(n,1),this.sendPropertyOfParent());var i=e.indexOf("_"),r=e.substring(i);-1!==this.files.findIndex((function(e){return e.name===r}))&&this.files.splice(n,1)}},{key:"remove",value:function(e){var t=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[t]),-1!==t&&(this.listOfNames.splice(t,1),this.sendPropertyOfParent());var n=e.indexOf("_"),i=e.substring(n);-1!==this.files.findIndex((function(e){return e.name===i}))&&this.files.splice(t,1),this.oneImage="assets/404.jpg"}},{key:"openInput",value:function(e){e.click()}},{key:"sendPropertyOfParent",value:function(){var e="";this.listOfNames.forEach((function(t){e+=t+";"})),this.eventSubmitToParent.next(e)}},{key:"submit",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,r,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new FormData,this.files.forEach((function(e){var t=s.setFileName(e);n.append("file",e,t),console.log(e)})),!n){t.next=10;break}return e.id&&!this.folderToSaveInServer.includes("_")&&(this.folderToSaveInServer="".concat(this.folderToSaveInServer,"_").concat(e.id)),t.next=5,this.filesService.uploadFiles(n,this.folderToSaveInServer).toPromise();case 5:return i=t.sent,t.next=8,this.filesService.deleteFiles(this.listToDelete,this.folderToSaveInServer).toPromise();case 8:r=t.sent,console.log(i,r);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"setFileName",value:function(e){return"".concat(e.lastModified,"_").concat(e.name)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(s.Qb(a.a),s.Qb("BASE_URL"))},e.\u0275cmp=s.Kb({type:e,selectors:[["app-upload-image"]],inputs:{nameBtn:"nameBtn",folderToSaveInServer:"folderToSaveInServer",multiple:"multiple",propertyOfParent:"propertyOfParent",eventSubmitToParent:"eventSubmitToParent",eventSubmitFromParent:"eventSubmitFromParent"},decls:11,vars:3,consts:[[1,"d-flex","mb-3","align-items-center"],["hidden","","multiple","","accept","image/*","type","file",3,"change"],["file1",""],["mat-raised-button","","type","button","color","accent",2,"height","fit-content",3,"click"],["class","ml-3",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"ml-3"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],[2,"width","70px","height","70px",3,"src","error"],["img",""],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"]],template:function(e,t){if(1&e){var n=s.Xb();s.Wb(0,"div",0),s.Wb(1,"input",1,2),s.ec("change",(function(e){return t.upload(e.target.files)})),s.Vb(),s.Wb(3,"button",3),s.ec("click",(function(){s.Cc(n);var e=s.Ac(2);return t.openInput(e)})),s.Wb(4,"mat-icon"),s.Lc(5,"add"),s.Vb(),s.Lc(6),s.Vb(),s.Lc(7," \xa0\xa0 "),s.Jc(8,f,2,1,"ng-container",4),s.Jc(9,m,5,1,"ng-template",null,5,s.Kc),s.Vb()}if(2&e){var i=s.Ac(10);s.Db(6),s.Nc(" ",t.nameBtn," "),s.Db(2),s.pc("ngIf",t.multiple)("ngIfElse",i)}},directives:[o.a,c.a,l.n,l.m],styles:["img[_ngcontent-%COMP%]{height:20px}"]}),e}()}}]);