function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"5WMv":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,i=n("mrSG"),s=n("XNiG"),a=n("fXoL"),o=n("kZa3"),c=n("LRne"),l=((r=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.call(this,"files")}return _createClass(n,[{key:"deleteFiles",value:function(e,t){return 0===e.length?Object(c.a)(null):this.http.post("".concat(this.urlApi,"/").concat(this.controller,"/deleteFiles/"),{filenames:e,folder:t},{reportProgress:!0})}},{key:"uploadFiles",value:function(e,t){return e?this.http.post("".concat(this.urlApi,"/").concat(this.controller,"/uploadFiles/").concat(t),e,{reportProgress:!0}):Object(c.a)(null)}}]),n}(o.a)).\u0275fac=function(e){return new(e||r)},r.\u0275prov=a.Mb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),u=n("ofXK"),f=n("bTqV"),p=n("NFeN");function h(e,t){if(1&e){var n=a.Xb();a.Wb(0,"div",8),a.Wb(1,"img",9,10),a.ec("error",(function(){a.Cc(n);var e=a.Ac(2);return a.ic(2).imgError(e)})),a.Vb(),a.Wb(3,"button",11),a.ec("click",(function(){a.Cc(n);var e=t.$implicit;return a.ic(2).removeFromImages(e.name)})),a.Wb(4,"mat-icon",12),a.Lc(5,"delete_sweep"),a.Vb(),a.Vb(),a.Vb()}if(2&e){var r=t.$implicit;a.Db(1),a.pc("src",r.image,a.Ec)}}function m(e,t){if(1&e){var n=a.Xb();a.Ub(0,5),a.Wb(1,"button",6),a.ec("click",(function(){a.Cc(n);var e=a.ic(),t=a.Ac(2);return e.openInput(t)})),a.Wb(2,"mat-icon"),a.Lc(3,"add"),a.Vb(),a.Lc(4),a.Vb(),a.Lc(5," \xa0\xa0 "),a.Jc(6,h,6,1,"div",7),a.Tb()}if(2&e){var r=a.ic();a.Db(4),a.Nc(" ",r.nameBtn," "),a.Db(2),a.pc("ngForOf",r.Images)}}function v(e,t){if(1&e){var n=a.Xb();a.Wb(0,"div",13),a.Wb(1,"div",14),a.Wb(2,"img",15,10),a.ec("error",(function(){a.Cc(n);var e=a.Ac(3);return a.ic().imgError(e)})),a.Vb(),a.Wb(4,"button",11),a.ec("click",(function(){a.Cc(n);var e=a.ic();return e.remove(e.oneImage)})),a.Wb(5,"mat-icon",12),a.Lc(6,"delete_sweep"),a.Vb(),a.Vb(),a.Vb(),a.Wb(7,"button",6),a.ec("click",(function(){a.Cc(n);var e=a.ic(),t=a.Ac(2);return e.openInput(t)})),a.Wb(8,"mat-icon"),a.Lc(9,"add"),a.Vb(),a.Lc(10),a.Vb(),a.Rb(11,"div",16),a.Vb()}if(2&e){var r=a.ic();a.Db(2),a.pc("src",r.oneImage,a.Ec),a.Db(8),a.Nc(" ",r.nameBtn," ")}}var g,d=((g=function(){function e(t,n){_classCallCheck(this,e),this.filesService=t,this.url=n,this.listOfNames=[],this.imagesToShow=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.folderToSaveInServer="folder",this.multiple=!1,this.oneImage="assets/404.jpg",this.Images=[],this.propertyOfParent=new s.a,this.eventSubmitToParent=new s.a,this.eventSubmitFromParent=new s.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.propertyOfParent.subscribe((function(t){if(t){var n=t.split(";");if(n.pop(),e.listOfNames=n,e.listToDelete=[],e.multiple)n.forEach((function(t,n){var r=t;if(null!==r&&r.startsWith("http"))e.Images[n]={name:r,image:r};else if(r){var i="".concat(e.url,"/").concat(e.folderToSaveInServer.replace("_","/"),"/").concat(r);e.Images[n]={name:i,image:i}}else e.Images[n]={name:"assets/404.jpg",image:"assets/404.jpg"}}));else{var r=0!==n.length?n[0]:t;e.oneImage=null!==r&&r.startsWith("http")?r:r?"".concat(e.url,"/").concat(e.folderToSaveInServer.replace("_","/"),"/").concat(r):"assets/404.jpg"}}})),this.eventSubmitFromParent.subscribe((function(t){return Object(i.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.submit(t);case 2:case"end":return e.stop()}}),e,this)})))}))}},{key:"upload",value:function(e){var t=this;if(this.multiple)for(var n=0;n<e.length;n++){var r=e.item(n);this.listOfNames.push(this.setFileName(r)),this.sendPropertyOfParent(),this.files.push(r),this.files.forEach((function(e,n){var r=new FileReader;r.onload=function(){-1===t.Images.findIndex((function(n){return t.setFileName(e).includes(n.name)}))&&t.Images.push({name:t.setFileName(e),image:r.result.toString()})},r.readAsDataURL(e)}))}else{var i=e.item(0);this.listOfNames=[],this.listOfNames.push(this.setFileName(i)),this.sendPropertyOfParent(),this.files=[],this.files.push(i),this.handleFileInput(i)}}},{key:"fileToImageFrom",value:function(){}},{key:"handleFileInput",value:function(e){var t=this,n=new FileReader;n.onload=function(){return t.oneImage=n.result.toString()},n.readAsDataURL(e)}},{key:"imgError",value:function(e){e.src="assets/404.jpg"}},{key:"setIcon",value:function(e){var t=e.lastIndexOf("."),n=e.substring(t+1);return"pdf"===n||"pdf;"===n?"assets/svg/pdf.svg":"assets/svg/word.svg"}},{key:"removeFromImages",value:function(e){var t=this.Images.findIndex((function(t){return e.includes(t.name)}));this.Images.splice(t,1);var n=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[n]),-1!==n&&(this.listOfNames.splice(n,1),this.sendPropertyOfParent());var r=e.indexOf("_"),i=e.substring(r);-1!==this.files.findIndex((function(e){return e.name===i}))&&this.files.splice(n,1)}},{key:"remove",value:function(e){var t=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[t]),-1!==t&&(this.listOfNames.splice(t,1),this.sendPropertyOfParent());var n=e.indexOf("_"),r=e.substring(n);-1!==this.files.findIndex((function(e){return e.name===r}))&&this.files.splice(t,1),this.oneImage="assets/404.jpg"}},{key:"openInput",value:function(e){e.click()}},{key:"sendPropertyOfParent",value:function(){var e="";this.listOfNames.forEach((function(t){e+=t+";"})),this.eventSubmitToParent.next(e)}},{key:"submit",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,s=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new FormData,this.files.forEach((function(e){var t=s.setFileName(e);n.append("file",e,t),console.log(e)})),!n){t.next=10;break}return e.id&&!this.folderToSaveInServer.includes("_")&&(this.folderToSaveInServer="".concat(this.folderToSaveInServer,"_").concat(e.id)),t.next=5,this.filesService.uploadFiles(n,this.folderToSaveInServer).toPromise();case 5:return r=t.sent,t.next=8,this.filesService.deleteFiles(this.listToDelete,this.folderToSaveInServer).toPromise();case 8:i=t.sent,console.log(this.folderToSaveInServer,r,i);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"setFileName",value:function(e){return"".concat(e.lastModified,"_").concat(e.name)}}]),e}()).\u0275fac=function(e){return new(e||g)(a.Qb(l),a.Qb("BASE_URL"))},g.\u0275cmp=a.Kb({type:g,selectors:[["app-upload-image"]],inputs:{nameBtn:"nameBtn",folderToSaveInServer:"folderToSaveInServer",multiple:"multiple",propertyOfParent:"propertyOfParent",eventSubmitToParent:"eventSubmitToParent",eventSubmitFromParent:"eventSubmitFromParent"},decls:6,vars:2,consts:[[1,"d-flex","mb-3","align-items-center"],["hidden","","multiple","","accept","image/*","type","file",3,"change"],["file1",""],["class","ml-3",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"ml-3"],["mat-raised-button","","type","button","color","accent",2,"height","fit-content",3,"click"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],[2,"width","70px","height","70px",3,"src","error"],["img",""],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"],[1,"row","align-items-center","justify-content-center"],[1,"col-md-12","mb-2"],[2,"width","170px","height","170px",3,"src","error"],[1,"col-md-12"]],template:function(e,t){if(1&e&&(a.Wb(0,"div",0),a.Wb(1,"input",1,2),a.ec("change",(function(e){return t.upload(e.target.files)})),a.Vb(),a.Jc(3,m,7,2,"ng-container",3),a.Jc(4,v,12,2,"ng-template",null,4,a.Kc),a.Vb()),2&e){var n=a.Ac(5);a.Db(3),a.pc("ngIf",t.multiple)("ngIfElse",n)}},directives:[u.n,f.a,p.a,u.m],styles:["img[_ngcontent-%COMP%]{height:20px}"]}),g)},J3i2:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("2Vo4"),i=n("fXoL"),s=n("sYmb"),a=function(){var e=function(){function e(t){_classCallCheck(this,e),this.translate=t,this.lang=new r.a(this.translate.currentLang),this.langSync="fr",this.isFr=!0}return _createClass(e,[{key:"init",value:function(){var e=localStorage.getItem("lang")||"fr";this.changeLanguage(e)}},{key:"changeLanguage",value:function(e){this.translate.setDefaultLang(e),this.translate.use(e),localStorage.setItem("lang",e),this.langSync=e,this.isFr="fr"===this.langSync}},{key:"currentLang",value:function(){return this.translate.onLangChange}},{key:"get",value:function(e){return this.translate.instant(e)}},{key:"getObs",value:function(e){return this.translate.stream(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.ac(s.d))},e.\u0275prov=i.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()}}]);