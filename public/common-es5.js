function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"5WMv":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("mrSG"),s=n("XNiG"),r=n("fXoL"),a=n("rdAd"),o=n("bTqV"),c=n("NFeN"),l=n("ofXK");function u(e,t){if(1&e){var n=r.Xb();r.Wb(0,"div",8),r.Wb(1,"img",9,10),r.ec("error",(function(){r.Cc(n);var e=r.Ac(2);return r.ic(2).imgError(e)})),r.Vb(),r.Wb(3,"button",11),r.ec("click",(function(){r.Cc(n);var e=t.$implicit;return r.ic(2).removeFromImages(e.name)})),r.Wb(4,"mat-icon",12),r.Lc(5,"delete_sweep"),r.Vb(),r.Vb(),r.Vb()}if(2&e){var i=t.$implicit;r.Db(1),r.pc("src",i.image,r.Ec)}}function f(e,t){if(1&e&&(r.Ub(0,6),r.Jc(1,u,6,1,"div",7),r.Tb()),2&e){var n=r.ic();r.Db(1),r.pc("ngForOf",n.Images)}}function m(e,t){if(1&e){var n=r.Xb();r.Wb(0,"img",9,10),r.ec("error",(function(){r.Cc(n);var e=r.Ac(1);return r.ic().imgError(e)})),r.Vb(),r.Wb(2,"button",11),r.ec("click",(function(){r.Cc(n);var e=r.ic();return e.remove(e.oneImage)})),r.Wb(3,"mat-icon",12),r.Lc(4,"delete_sweep"),r.Vb(),r.Vb()}if(2&e){var i=r.ic();r.pc("src",i.oneImage,r.Ec)}}var p=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this.filesService=t,this.url=n,this.listOfNames=[],this.imagesToShow=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.folderToSaveInServer="folder",this.multiple=!1,this.oneImage="assets/404.jpg",this.Images=[],this.propertyOfParent=new s.a,this.eventSubmitToParent=new s.a,this.eventSubmitFromParent=new s.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.propertyOfParent.subscribe((function(t){if(t){var n=t.split(";");if(n.pop(),e.listOfNames=n,e.listToDelete=[],console.log(n),e.multiple)n.forEach((function(t,n){var i=t;if(null!==i&&i.startsWith("http"))e.Images[n]={name:i,image:i};else if(i){var s="".concat(e.url,"/").concat(e.folderToSaveInServer.replace("_","/"),"/").concat(i);e.Images[n]={name:s,image:s}}else e.Images[n]={name:"assets/404.jpg",image:"assets/404.jpg"}}));else{var i=0!==n.length?n[0]:null;e.oneImage=null!==i&&i.startsWith("http")?i:i?"".concat(e.url,"/").concat(e.folderToSaveInServer,"/").concat(i):"assets/404.jpg"}}})),this.eventSubmitFromParent.subscribe((function(t){return Object(i.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.submit(t);case 2:case"end":return e.stop()}}),e,this)})))}))}},{key:"upload",value:function(e){var t=this;if(this.multiple)for(var n=0;n<e.length;n++){var i=e.item(n);this.listOfNames.push(this.setFileName(i)),this.sendPropertyOfParent(),this.files.push(i),this.files.forEach((function(e,n){var i=new FileReader;i.onload=function(){-1===t.Images.findIndex((function(n){return t.setFileName(e).includes(n.name)}))&&t.Images.push({name:t.setFileName(e),image:i.result.toString()})},i.readAsDataURL(e)}))}else{var s=e.item(0);this.listOfNames=[],this.listOfNames.push(this.setFileName(s)),this.sendPropertyOfParent(),this.files=[],this.files.push(s),this.handleFileInput(s)}}},{key:"fileToImageFrom",value:function(){}},{key:"handleFileInput",value:function(e){var t=this,n=new FileReader;n.onload=function(){return t.oneImage=n.result.toString()},n.readAsDataURL(e)}},{key:"imgError",value:function(e){e.src="assets/404.jpg"}},{key:"setIcon",value:function(e){var t=e.lastIndexOf("."),n=e.substring(t+1);return"pdf"===n||"pdf;"===n?"assets/svg/pdf.svg":"assets/svg/word.svg"}},{key:"removeFromImages",value:function(e){var t=this.Images.findIndex((function(t){return e.includes(t.name)}));this.Images.splice(t,1);var n=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[n]),-1!==n&&(this.listOfNames.splice(n,1),this.sendPropertyOfParent());var i=e.indexOf("_"),s=e.substring(i);-1!==this.files.findIndex((function(e){return e.name===s}))&&this.files.splice(n,1)}},{key:"remove",value:function(e){var t=this.listOfNames.findIndex((function(t){return e.includes(t)}));this.listToDelete.push(this.listOfNames[t]),-1!==t&&(this.listOfNames.splice(t,1),this.sendPropertyOfParent());var n=e.indexOf("_"),i=e.substring(n);-1!==this.files.findIndex((function(e){return e.name===i}))&&this.files.splice(t,1),this.oneImage="assets/404.jpg"}},{key:"openInput",value:function(e){e.click()}},{key:"sendPropertyOfParent",value:function(){var e="";this.listOfNames.forEach((function(t){e+=t+";"})),this.eventSubmitToParent.next(e)}},{key:"submit",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,i,s,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=new FormData,this.files.forEach((function(e){var t=r.setFileName(e);n.append("file",e,t),console.log(e)})),!n){t.next=10;break}return e.id&&!this.folderToSaveInServer.includes("_")&&(this.folderToSaveInServer="".concat(this.folderToSaveInServer,"_").concat(e.id)),t.next=5,this.filesService.uploadFiles(n,this.folderToSaveInServer).toPromise();case 5:return i=t.sent,t.next=8,this.filesService.deleteFiles(this.listToDelete,this.folderToSaveInServer).toPromise();case 8:s=t.sent,console.log(i,s);case 10:case"end":return t.stop()}}),t,this)})))}},{key:"setFileName",value:function(e){return"".concat(e.lastModified,"_").concat(e.name)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Qb(a.a),r.Qb("BASE_URL"))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-upload-image"]],inputs:{nameBtn:"nameBtn",folderToSaveInServer:"folderToSaveInServer",multiple:"multiple",propertyOfParent:"propertyOfParent",eventSubmitToParent:"eventSubmitToParent",eventSubmitFromParent:"eventSubmitFromParent"},decls:11,vars:3,consts:[[1,"d-flex","mb-3","align-items-center"],["hidden","","multiple","","accept","image/*","type","file",3,"change"],["file1",""],["mat-raised-button","","type","button","color","accent",2,"height","fit-content",3,"click"],["class","ml-3",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"ml-3"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],[2,"width","70px","height","70px",3,"src","error"],["img",""],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"]],template:function(e,t){if(1&e){var n=r.Xb();r.Wb(0,"div",0),r.Wb(1,"input",1,2),r.ec("change",(function(e){return t.upload(e.target.files)})),r.Vb(),r.Wb(3,"button",3),r.ec("click",(function(){r.Cc(n);var e=r.Ac(2);return t.openInput(e)})),r.Wb(4,"mat-icon"),r.Lc(5,"add"),r.Vb(),r.Lc(6),r.Vb(),r.Lc(7," \xa0\xa0 "),r.Jc(8,f,2,1,"ng-container",4),r.Jc(9,m,5,1,"ng-template",null,5,r.Kc),r.Vb()}if(2&e){var i=r.Ac(10);r.Db(6),r.Nc(" ",t.nameBtn," "),r.Db(2),r.pc("ngIf",t.multiple)("ngIfElse",i)}},directives:[o.a,c.a,l.n,l.m],styles:["img[_ngcontent-%COMP%]{height:20px}"]}),e}()},"5nPQ":function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var i=n("mrSG"),s=n("XNiG"),r=n("tk/3"),a=n("2ChS"),o=n("Cfvw"),c=n("lJxs"),l=n("0EUg"),u=n("fXoL"),f=n("rdAd"),m=n("MutI"),p=n("bTqV"),d=n("NFeN"),h=n("ofXK"),b=n("FKr1"),v=n("bv9b");function g(e,t){if(1&e&&(u.Wb(0,"div"),u.Wb(1,"a",2),u.Wb(2,"div",3),u.Wb(3,"div",4),u.Wb(4,"p",5),u.Lc(5),u.Vb(),u.Wb(6,"span",6),u.Lc(7),u.jc(8,"async"),u.Vb(),u.Vb(),u.Rb(9,"mat-progress-bar",7),u.jc(10,"async"),u.Vb(),u.Vb(),u.Vb()),2&e){var n=t.$implicit;u.Db(5),u.Nc("- ",n.name,""),u.Db(2),u.Nc("",u.kc(8,3,n.progressValue)," %"),u.Db(2),u.pc("value",u.kc(10,5,n.progressValue))}}var y,I=((y=function(){function e(t,n,i){_classCallCheck(this,e),this.bottomSheetRef=t,this.data=n,this.service=i,this.files=[],this.folder="",this.list=[],this.uploadCompleted=0}return _createClass(e,[{key:"ngOnInit",value:function(){try{this.handleUpload()}catch(e){console.warn(e)}}},{key:"handleUpload",value:function(){var e=this;this.files=this.data.files,this.folder=this.data.folder;var t=new FormData,n=[];this.list=[],this.files.forEach((function(i,r){var a="".concat(i.size,"_").concat(i.lastModified,"_").concat(i.name);e.list.push({fileId:i.size+i.lastModified,name:i.name,progressValue:new s.a}),t.append("file_"+r,i,a),n.push(e.service.uploadFiles(t,e.folder).pipe(Object(c.a)((function(t){return e.getEventMessage(t,i)}))))})),t.append("length",""+this.files.length),Object(o.a)(n).pipe(Object(l.a)()).subscribe((function(t){e.list.length===e.uploadCompleted&&(setTimeout((function(){e.bottomSheetRef.dismiss(".")}),500),console.log(t))}))}},{key:"updateListOfProgress",value:function(e,t){var n=this.list.findIndex((function(t){return+t.fileId==+e}));n>-1&&this.list[n].progressValue.next(t)}},{key:"trackFn",value:function(e,t){return t.progressValue}},{key:"getEventMessage",value:function(e,t){switch(e.type){case r.e.Sent:return'Uploading file "'.concat(t.name.substring(0,10),'" of size ').concat(t.size,".");case r.e.UploadProgress:var n=Math.round(100*e.loaded/e.total);return this.updateListOfProgress(t.size+t.lastModified,n),'File "'.concat(t.name.substring(0,10),'" is ').concat(n,"% uploaded.");case r.e.Response:return this.uploadCompleted++,'File "'.concat(t.name.substring(0,10),'" was completely uploaded!');default:return'File "'.concat(t.name.substring(0,10),'" surprising upload event: ').concat(e,".")}}}]),e}()).\u0275fac=function(e){return new(e||y)(u.Qb(a.e),u.Qb(a.a),u.Qb(f.a))},y.\u0275cmp=u.Kb({type:y,selectors:[["app-progress"]],decls:5,vars:2,consts:[["mat-icon-button","","color","warn",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["mat-list-item",""],[2,"width","100%"],[1,"space-between"],["mat-line","",2,"font-size",".8em"],[2,"font-size",".8em"],["mode","determinate",3,"value"]],template:function(e,t){1&e&&(u.Wb(0,"mat-nav-list"),u.Wb(1,"button",0),u.ec("click",(function(){return t.bottomSheetRef.dismiss(".")})),u.Wb(2,"mat-icon"),u.Lc(3,"highlight_off"),u.Vb(),u.Vb(),u.Jc(4,g,11,7,"div",1),u.Vb()),2&e&&(u.Db(4),u.pc("ngForOf",t.list)("ngForTrackBy",t.trackFn))},directives:[m.c,p.a,d.a,h.m,m.a,b.k,v.a],pipes:[h.b],styles:[".space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]}),y);function S(e,t){if(1&e){var n=u.Xb();u.Wb(0,"button",8),u.ec("click",(function(){return u.Cc(n),u.ic().submit(null)})),u.Wb(1,"mat-icon"),u.Lc(2,"add"),u.Vb(),u.Lc(3," Submit "),u.Vb()}}function k(e,t){if(1&e){var n=u.Xb();u.Wb(0,"p",9),u.Wb(1,"span"),u.Lc(2),u.Vb(),u.Wb(3,"button",10),u.ec("click",(function(){u.Cc(n);var e=t.$implicit;return u.ic().remove(e)})),u.Wb(4,"mat-icon",11),u.Lc(5,"delete_sweep"),u.Vb(),u.Vb(),u.Vb()}if(2&e){var i=t.$implicit;u.Db(2),u.Nc("- ",i.substring(14),"")}}var O,w=((O=function(){function e(t,n){_classCallCheck(this,e),this.service=t,this.bottomSheet=n,this.accepts={doc:"application/pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",video:"video/mp4,video/*",audio:"audio/*",image:"image/*",doc2:".pdf,.doc,.docx"},this.listOfNames=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.accept="doc",this.config={multiple:!0,showSubmitButton:!0,folderToSaveInServer:"folder",propertyStringToParent:new s.a,propertyStringToUploader:new s.a,eventSubmitToUploader:new s.a}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.config.propertyStringToUploader.subscribe((function(t){if(t){var n=t.split(";");n.pop(),e.listOfNames=n,e.listToDelete=[]}})),this.config.eventSubmitToUploader.subscribe((function(t){return Object(i.b)(e,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.submit(t);case 2:case"end":return e.stop()}}),e,this)})))}))}},{key:"upload",value:function(e){for(var t=0;t<e.length;t++){var n=e.item(t);this.config.multiple?this.listOfNames.push(this.setFileName(n)):(this.listToDelete.push(this.listOfNames[0]),this.listOfNames=[this.setFileName(n)]),this.sendPropertyOfParent(),this.files.push(n)}}},{key:"setIcon",value:function(e){var t=e.lastIndexOf("."),n=e.substring(t+1);return"pdf"===n||"pdf;"===n?"assets/svg/pdf.svg":"assets/svg/word.svg"}},{key:"remove",value:function(e){var t=this.listOfNames.findIndex((function(t){return t===e}));-1!==t&&(this.listOfNames.splice(t,1),this.sendPropertyOfParent()),this.listToDelete.push(e);var n=e.indexOf("_"),i=e.substring(n);-1!==this.files.findIndex((function(e){return e.name===i}))&&this.files.splice(t,1)}},{key:"openInput",value:function(e){e.click()}},{key:"sendPropertyOfParent",value:function(){var e="";this.listOfNames.forEach((function(t){e+=t+";"})),this.config.propertyStringToParent.next(e)}},{key:"submit",value:function(e){return Object(i.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.id&&!this.config.folderToSaveInServer.includes("_")&&(this.config.folderToSaveInServer="".concat(this.config.folderToSaveInServer,"_").concat(e.id)),this.bottomSheet.open(I,{data:{files:this.files,folder:this.config.folderToSaveInServer},panelClass:"my-component-bottom-sheet"}).afterDismissed().subscribe((function(e){return Object(i.b)(n,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Bottom sheet has been dismissed ",e),t.next=3,this.service.deleteFiles(this.listToDelete,this.config.folderToSaveInServer).toPromise();case 3:n=t.sent,console.log(n);case 5:case"end":return t.stop()}}),t,this)})))}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setFileName",value:function(e){return"".concat(e.size,"_").concat(e.lastModified,"_").concat(e.name)}}]),e}()).\u0275fac=function(e){return new(e||O)(u.Qb(f.a),u.Qb(a.c))},O.\u0275cmp=u.Kb({type:O,selectors:[["app-upload"]],inputs:{nameBtn:"nameBtn",accept:"accept",config:"config"},decls:13,vars:5,consts:[[1,"row"],[1,"col-md-12","mb-3"],[1,"myrow"],["hidden","","type","file",3,"accept","multiple","change"],["e",""],["mat-raised-button","","type","button","color","accent",3,"click"],["mat-raised-button","","type","button","color","primary",3,"click",4,"ngIf"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],["mat-raised-button","","type","button","color","primary",3,"click"],[2,"font-size",".7em","margin","0"],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"]],template:function(e,t){if(1&e){var n=u.Xb();u.Wb(0,"div",0),u.Wb(1,"div",1),u.Wb(2,"div",2),u.Wb(3,"input",3,4),u.ec("change",(function(){u.Cc(n);var e=u.Ac(4);return t.upload(e.files)})),u.Vb(),u.Wb(5,"button",5),u.ec("click",(function(){u.Cc(n);var e=u.Ac(4);return t.openInput(e)})),u.Wb(6,"mat-icon"),u.Lc(7,"add"),u.Vb(),u.Lc(8),u.Vb(),u.Jc(9,S,4,0,"button",6),u.Lc(10," \xa0\xa0 "),u.Wb(11,"div",2),u.Jc(12,k,6,1,"p",7),u.Vb(),u.Vb(),u.Vb(),u.Vb()}2&e&&(u.Db(3),u.pc("accept",t.accepts[t.accept])("multiple",t.config.multiple),u.Db(5),u.Nc(" ",t.nameBtn," "),u.Db(1),u.pc("ngIf",t.config.showSubmitButton),u.Db(3),u.pc("ngForOf",t.listOfNames))},directives:[p.a,d.a,h.n,h.m],styles:[".my-component-bottom-sheet{min-width:80vw!important}"]}),O)}}]);