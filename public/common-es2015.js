(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"5WMv":function(t,e,i){"use strict";i.d(e,"a",function(){return m});var s=i("mrSG"),n=i("XNiG"),o=i("fXoL"),c=i("rdAd"),r=i("bTqV"),a=i("NFeN"),l=i("ofXK");function f(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",8),o.Ub(1,"img",9,10),o.bc("error",function(){o.zc(t);const e=o.xc(2);return o.fc(2).imgError(e)}),o.Tb(),o.Ub(3,"button",11),o.bc("click",function(){o.zc(t);const i=e.$implicit;return o.fc(2).removeFromImages(i.name)}),o.Ub(4,"mat-icon",12),o.Kc(5,"delete_sweep"),o.Tb(),o.Tb(),o.Tb()}if(2&t){const t=e.$implicit;o.Cb(1),o.mc("src",t.image,o.Bc)}}function d(t,e){if(1&t&&(o.Sb(0,6),o.Ic(1,f,6,1,"div",7),o.Rb()),2&t){const t=o.fc();o.Cb(1),o.mc("ngForOf",t.Images)}}function u(t,e){if(1&t){const t=o.Vb();o.Ub(0,"img",9,10),o.bc("error",function(){o.zc(t);const e=o.xc(1);return o.fc().imgError(e)}),o.Tb(),o.Ub(2,"button",11),o.bc("click",function(){o.zc(t);const e=o.fc();return e.remove(e.oneImage)}),o.Ub(3,"mat-icon",12),o.Kc(4,"delete_sweep"),o.Tb(),o.Tb()}if(2&t){const t=o.fc();o.mc("src",t.oneImage,o.Bc)}}let m=(()=>{class t{constructor(t,e){this.filesService=t,this.url=e,this.listOfNames=[],this.imagesToShow=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.folderToSaveInServer="folder",this.multiple=!1,this.oneImage="assets/404.png",this.Images=[],this.propertyOfParent=new n.a,this.eventSubmitToParent=new n.a,this.eventSubmitFromParent=new n.a}ngOnInit(){this.propertyOfParent.subscribe(t=>{if(!t)return;const e=t.split(";");if(e.pop(),this.listOfNames=e,this.listToDelete=[],console.log(e),this.multiple)e.forEach((t,e)=>{const i=t;if(null!==i&&i.startsWith("http"))this.Images[e]={name:i,image:i};else if(i){const t=`${this.url}/${this.folderToSaveInServer.replace("_","/")}/${i}`;this.Images[e]={name:t,image:t}}else this.Images[e]={name:"assets/404.png",image:"assets/404.png"}});else{const t=0!==e.length?e[0]:null;this.oneImage=null!==t&&t.startsWith("http")?t:t?`${this.url}/${this.folderToSaveInServer.replace("_","/")}/${t}`:"assets/404.png"}}),this.eventSubmitFromParent.subscribe(t=>Object(s.a)(this,void 0,void 0,function*(){yield this.submit(t)}))}upload(t){if(this.multiple)for(let e=0;e<t.length;e++){const i=t.item(e);this.listOfNames.push(this.setFileName(i)),this.sendPropertyOfParent(),this.files.push(i),this.files.forEach((t,e)=>{const i=new FileReader;i.onload=()=>{-1===this.Images.findIndex(e=>this.setFileName(t).includes(e.name))&&this.Images.push({name:this.setFileName(t),image:i.result.toString()})},i.readAsDataURL(t)})}else{const e=t.item(0);this.listOfNames=[],this.listOfNames.push(this.setFileName(e)),this.sendPropertyOfParent(),this.files=[],this.files.push(e),this.handleFileInput(e)}}fileToImageFrom(){}handleFileInput(t){const e=new FileReader;e.onload=()=>this.oneImage=e.result.toString(),e.readAsDataURL(t)}imgError(t){t.src="assets/404.png"}removeFromImages(t){const e=this.Images.findIndex(e=>t.includes(e.name));this.Images.splice(e,1);const i=this.listOfNames.findIndex(e=>t.includes(e));this.listToDelete.push(this.listOfNames[i]),-1!==i&&(this.listOfNames.splice(i,1),this.sendPropertyOfParent());const s=t.indexOf("_"),n=t.substring(s);-1!==this.files.findIndex(t=>t.name===n)&&this.files.splice(i,1)}remove(t){const e=this.listOfNames.findIndex(e=>t.includes(e));this.listToDelete.push(this.listOfNames[e]),-1!==e&&(this.listOfNames.splice(e,1),this.sendPropertyOfParent());const i=t.indexOf("_"),s=t.substring(i);-1!==this.files.findIndex(t=>t.name===s)&&this.files.splice(e,1),this.oneImage="assets/404.png"}openInput(t){t.click()}sendPropertyOfParent(){let t="";this.listOfNames.forEach(e=>{t+=e+";"}),this.eventSubmitToParent.next(t)}submit(t){return Object(s.a)(this,void 0,void 0,function*(){const e=new FormData;if(this.files.forEach((t,i)=>{const s=this.setFileName(t);e.append("file_"+i,t,s),console.log(t)}),e.append("length",""+this.files.length),e){t.id&&!this.folderToSaveInServer.includes("_")&&(this.folderToSaveInServer=`${this.folderToSaveInServer}_${t.id}`);const i=yield this.filesService.uploadFiles(e,this.folderToSaveInServer).toPromise(),s=yield this.filesService.deleteFiles(this.listToDelete,this.folderToSaveInServer).toPromise();console.log(i,s)}})}setFileName(t){return`${t.lastModified}_${t.name}`}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(c.a),o.Ob("BASE_URL"))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-upload-image"]],inputs:{nameBtn:"nameBtn",folderToSaveInServer:"folderToSaveInServer",multiple:"multiple",propertyOfParent:"propertyOfParent",eventSubmitToParent:"eventSubmitToParent",eventSubmitFromParent:"eventSubmitFromParent"},decls:11,vars:3,consts:[[1,"d-flex","mb-3","align-items-center"],["hidden","","multiple","","accept","image/*","type","file",3,"change"],["file1",""],["mat-raised-button","","type","button","color","accent",2,"height","fit-content",3,"click"],["class","ml-3",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"ml-3"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],[2,"width","70px","height","70px",3,"src","error"],["img",""],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"]],template:function(t,e){if(1&t){const t=o.Vb();o.Ub(0,"div",0),o.Ub(1,"input",1,2),o.bc("change",function(t){return e.upload(t.target.files)}),o.Tb(),o.Ub(3,"button",3),o.bc("click",function(){o.zc(t);const i=o.xc(2);return e.openInput(i)}),o.Ub(4,"mat-icon"),o.Kc(5,"add"),o.Tb(),o.Kc(6),o.Tb(),o.Kc(7," \xa0\xa0 "),o.Ic(8,d,2,1,"ng-container",4),o.Ic(9,u,5,1,"ng-template",null,5,o.Jc),o.Tb()}if(2&t){const t=o.xc(10);o.Cb(6),o.Mc(" ",e.nameBtn," "),o.Cb(2),o.mc("ngIf",e.multiple)("ngIfElse",t)}},directives:[r.a,a.a,l.n,l.m],styles:["img[_ngcontent-%COMP%]{height:20px}"]}),t})()},"5nPQ":function(t,e,i){"use strict";i.d(e,"a",function(){return S});var s=i("mrSG"),n=i("XNiG"),o=i("tk/3"),c=i("2ChS"),r=i("Cfvw"),a=i("lJxs"),l=i("0EUg"),f=i("fXoL"),d=i("rdAd"),u=i("MutI"),m=i("bTqV"),p=i("NFeN"),b=i("ofXK"),h=i("FKr1"),g=i("bv9b");function v(t,e){if(1&t&&(f.Ub(0,"div"),f.Ub(1,"a",2),f.Ub(2,"div",3),f.Ub(3,"div",4),f.Ub(4,"p",5),f.Kc(5),f.Tb(),f.Ub(6,"span",6),f.Kc(7),f.gc(8,"async"),f.Tb(),f.Tb(),f.Pb(9,"mat-progress-bar",7),f.gc(10,"async"),f.Tb(),f.Tb(),f.Tb()),2&t){const t=e.$implicit;f.Cb(5),f.Mc("- ",t.name,""),f.Cb(2),f.Mc("",f.hc(8,3,t.progressValue)," %"),f.Cb(2),f.mc("value",f.hc(10,5,t.progressValue))}}let T=(()=>{class t{constructor(t,e,i){this.bottomSheetRef=t,this.data=e,this.service=i,this.files=[],this.folder="",this.list=[],this.uploadCompleted=0}ngOnInit(){try{this.handleUpload()}catch(t){console.warn(t)}}handleUpload(){this.files=this.data.files,0===this.files.length&&this.bottomSheetRef.dismiss("."),this.folder=this.data.folder;const t=new FormData,e=[];this.list=[],this.files.forEach((i,s)=>{const o=`${i.size}_${i.lastModified}_${i.name}`;this.list.push({fileId:i.size+i.lastModified,name:i.name,progressValue:new n.a}),t.append("file_"+s,i,o),e.push(this.service.uploadFiles(t,this.folder).pipe(Object(a.a)(t=>this.getEventMessage(t,i))))}),t.append("length",""+this.files.length),Object(r.a)(e).pipe(Object(l.a)()).subscribe(t=>{this.list.length===this.uploadCompleted&&(setTimeout(()=>{this.bottomSheetRef.dismiss(".")},500),console.log(t))})}updateListOfProgress(t,e){const i=this.list.findIndex(e=>+e.fileId==+t);i>-1&&this.list[i].progressValue.next(e)}trackFn(t,e){return e.progressValue}getEventMessage(t,e){switch(t.type){case o.e.Sent:return`Uploading file "${e.name.substring(0,10)}" of size ${e.size}.`;case o.e.UploadProgress:const i=Math.round(100*t.loaded/t.total);return this.updateListOfProgress(e.size+e.lastModified,i),`File "${e.name.substring(0,10)}" is ${i}% uploaded.`;case o.e.Response:return this.uploadCompleted++,`File "${e.name.substring(0,10)}" was completely uploaded!`;default:return`File "${e.name.substring(0,10)}" surprising upload event: ${t}.`}}}return t.\u0275fac=function(e){return new(e||t)(f.Ob(c.d),f.Ob(c.a),f.Ob(d.a))},t.\u0275cmp=f.Ib({type:t,selectors:[["app-progress"]],decls:5,vars:2,consts:[["mat-icon-button","","color","warn",3,"click"],[4,"ngFor","ngForOf","ngForTrackBy"],["mat-list-item",""],[2,"width","100%"],[1,"space-between"],["mat-line","",2,"font-size",".8em"],[2,"font-size",".8em"],["mode","determinate",3,"value"]],template:function(t,e){1&t&&(f.Ub(0,"mat-nav-list"),f.Ub(1,"button",0),f.bc("click",function(){return e.bottomSheetRef.dismiss(".")}),f.Ub(2,"mat-icon"),f.Kc(3,"highlight_off"),f.Tb(),f.Tb(),f.Ic(4,v,11,7,"div",1),f.Tb()),2&t&&(f.Cb(4),f.mc("ngForOf",e.list)("ngForTrackBy",e.trackFn))},directives:[u.c,m.a,p.a,b.m,u.a,h.k,g.a],pipes:[b.b],styles:[".space-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}"]}),t})();function I(t,e){if(1&t){const t=f.Vb();f.Ub(0,"button",5),f.bc("click",function(){return f.zc(t),f.fc().submit(null)}),f.Ub(1,"mat-icon"),f.Kc(2,"add"),f.Tb(),f.Kc(3," Submit "),f.Tb()}if(2&t){const t=f.fc();f.mc("color",t.color)}}function O(t,e){if(1&t){const t=f.Vb();f.Ub(0,"p",8),f.Ub(1,"span"),f.Kc(2),f.Tb(),f.Ub(3,"button",9),f.bc("click",function(){f.zc(t);const i=e.$implicit;return f.fc().remove(i)}),f.Ub(4,"mat-icon",10),f.Kc(5,"delete_sweep"),f.Tb(),f.Tb(),f.Tb()}if(2&t){const t=e.$implicit;f.Cb(2),f.Mc("- ",t.substring(14),"")}}let S=(()=>{class t{constructor(t,e){this.service=t,this.bottomSheet=e,this.accepts={doc:"application/pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",video:"video/mp4,video/*",audio:"audio/*",image:"image/*",doc2:".pdf,.doc,.docx"},this.listOfNames=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.color="",this.accept="doc",this.config={multiple:!0,showSubmitButton:!0,folderToSaveInServer:"folder",propertyStringToParent:new n.a,propertyStringToUploader:new n.a,eventSubmitToUploader:new n.a}}ngOnInit(){this.config.propertyStringToUploader.subscribe(t=>{if(!t)return;const e=t.split(";");e.pop(),this.listOfNames=e,this.listToDelete=[]}),this.config.eventSubmitToUploader.subscribe(t=>Object(s.a)(this,void 0,void 0,function*(){yield this.submit(t)}))}upload(t){for(let e=0;e<t.length;e++){const i=t.item(e);this.config.multiple?this.listOfNames.push(this.setFileName(i)):(this.listToDelete.push(this.listOfNames[0]),this.listOfNames=[this.setFileName(i)]),this.sendPropertyOfParent(),this.files.push(i)}}setIcon(t){const e=t.lastIndexOf("."),i=t.substring(e+1);return"pdf"===i||"pdf;"===i?"assets/svg/pdf.svg":"assets/svg/word.svg"}remove(t){const e=this.listOfNames.findIndex(e=>e===t);-1!==e&&(this.listOfNames.splice(e,1),this.sendPropertyOfParent()),this.listToDelete.push(t);const i=t.indexOf("_"),s=t.substring(i);-1!==this.files.findIndex(t=>t.name===s)&&this.files.splice(e,1)}openInput(t){t.click()}sendPropertyOfParent(){let t="";this.listOfNames.forEach(e=>{t+=e+";"}),this.config.propertyStringToParent.next(t)}submit(t){return Object(s.a)(this,void 0,void 0,function*(){t.id&&!this.config.folderToSaveInServer.includes("_")&&(this.config.folderToSaveInServer=`${this.config.folderToSaveInServer}_${t.id}`),this.bottomSheet.open(T,{data:{files:this.files,folder:this.config.folderToSaveInServer},panelClass:"my-component-bottom-sheet"}).afterDismissed().subscribe(t=>Object(s.a)(this,void 0,void 0,function*(){console.log("Bottom sheet has been dismissed ",t);const e=yield this.service.deleteFiles(this.listToDelete,this.config.folderToSaveInServer).toPromise();console.log(e)}))})}setFileName(t){return`${t.size}_${t.lastModified}_${t.name}`}}return t.\u0275fac=function(e){return new(e||t)(f.Ob(d.a),f.Ob(c.b))},t.\u0275cmp=f.Ib({type:t,selectors:[["app-upload"]],inputs:{nameBtn:"nameBtn",color:"color",accept:"accept",config:"config"},decls:13,vars:6,consts:[[1,"row"],[1,"col-md-12","mb-3"],[1,"myrow"],["hidden","","type","file",3,"accept","multiple","change"],["e",""],["mat-raised-button","","type","button",3,"color","click"],["mat-raised-button","","type","button",3,"color","click",4,"ngIf"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"]],template:function(t,e){if(1&t){const t=f.Vb();f.Ub(0,"div",0),f.Ub(1,"div",1),f.Ub(2,"div",2),f.Ub(3,"input",3,4),f.bc("change",function(){f.zc(t);const i=f.xc(4);return e.upload(i.files)}),f.Tb(),f.Ub(5,"button",5),f.bc("click",function(){f.zc(t);const i=f.xc(4);return e.openInput(i)}),f.Ub(6,"mat-icon"),f.Kc(7,"add"),f.Tb(),f.Kc(8),f.Tb(),f.Ic(9,I,4,1,"button",6),f.Kc(10," \xa0\xa0 "),f.Ub(11,"div",2),f.Ic(12,O,6,1,"p",7),f.Tb(),f.Tb(),f.Tb(),f.Tb()}2&t&&(f.Cb(3),f.mc("accept",e.accepts[e.accept])("multiple",e.config.multiple),f.Cb(2),f.mc("color",e.color),f.Cb(3),f.Mc(" ",e.nameBtn," "),f.Cb(1),f.mc("ngIf",e.config.showSubmitButton),f.Cb(3),f.mc("ngForOf",e.listOfNames))},directives:[m.a,p.a,b.n,b.m],styles:[".my-component-bottom-sheet{min-width:80vw!important}"]}),t})()},"8lcG":function(t,e,i){"use strict";i.d(e,"a",function(){return n});var s=i("fXoL");let n=(()=>{class t{constructor(){this.name=""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},Fr4G:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var s=i("tk/3"),n=i("ofXK"),o=i("NFeN"),c=i("MutI"),r=i("rdAd"),a=i("bTqV"),l=i("bv9b"),f=i("3Pt+"),d=i("fXoL");let u=(()=>{class t{}return t.\u0275mod=d.Mb({type:t}),t.\u0275inj=d.Lb({factory:function(e){return new(e||t)},providers:[r.a],imports:[[n.c,o.b,c.b,a.b,l.b,f.j,f.s,s.c]]}),t})()},ZTdd:function(t,e,i){"use strict";i.d(e,"a",function(){return d});var s=i("mrSG"),n=i("2ChS"),o=i("fXoL"),c=i("MutI"),r=i("ofXK"),a=i("FKr1");function l(t,e){if(1&t){const t=o.Vb();o.Ub(0,"a",2),o.bc("click",function(){o.zc(t);const e=o.fc().$implicit;return o.fc().openLink(e)}),o.Ub(1,"span",3),o.Kc(2),o.Tb(),o.Tb()}if(2&t){const t=o.fc().$implicit;o.Cb(2),o.Mc("- ",t,"")}}function f(t,e){if(1&t&&(o.Ub(0,"div"),o.Ic(1,l,3,1,"a",1),o.Tb()),2&t){const t=e.$implicit;o.Cb(1),o.mc("ngIf",""!==t)}}let d=(()=>{class t{constructor(t,e,i){this.bottomSheetRef=t,this.data=e,this.url=i,this.list=[],this.folder="",this.id=0}ngOnInit(){if(this.data.elementUrl){const t=this.data.elementUrl.split(";");this.id=this.data.id,t.pop(),this.folder=this.data.folder,this.list=t}}openLink(t){return Object(s.a)(this,void 0,void 0,function*(){t.includes("http")?window.open(t,"_blanc"):window.open(`${this.url}/${this.folder}/${this.id}/${t}`,"_blanc")})}}return t.\u0275fac=function(e){return new(e||t)(o.Ob(n.d),o.Ob(n.a),o.Ob("BASE_URL"))},t.\u0275cmp=o.Ib({type:t,selectors:[["app-download-sheet"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["mat-list-item","",3,"click",4,"ngIf"],["mat-list-item","",3,"click"],["mat-line",""]],template:function(t,e){1&t&&(o.Ub(0,"mat-nav-list"),o.Ic(1,f,2,1,"div",0),o.Tb()),2&t&&(o.Cb(1),o.mc("ngForOf",e.list))},directives:[c.c,r.m,r.n,c.a,a.k],styles:[""]}),t})()},hUFt:function(t,e,i){"use strict";i.d(e,"a",function(){return l});var s=i("0IaG"),n=i("fXoL"),o=i("/t3+"),c=i("f0Cb"),r=i("bTqV");let a=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.model=""}ngOnInit(){this.model=this.data.model}onNoClick(){this.dialogRef.close()}onOkClick(){this.dialogRef.close("ok")}}return t.\u0275fac=function(e){return new(e||t)(n.Ob(s.g),n.Ob(s.a))},t.\u0275cmp=n.Ib({type:t,selectors:[["app-delete"]],decls:15,vars:1,consts:[[1,"dialog"],["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"content"],["mat-dialog-content",""],["align","end"],["mat-raised-button","","type","button",3,"click"],["mat-raised-button","","color","warn","type","button","cdkFocusInitial","",3,"mat-dialog-close","click"]],template:function(t,e){1&t&&(n.Ub(0,"div",0),n.Ub(1,"h1",1),n.Ub(2,"mat-toolbar",2),n.Ub(3,"span"),n.Kc(4),n.Tb(),n.Tb(),n.Pb(5,"mat-divider"),n.Tb(),n.Ub(6,"div",3),n.Ub(7,"mat-dialog-content",4),n.Ub(8,"p"),n.Kc(9,"Voulez-vous vraiment supprimer ?"),n.Tb(),n.Tb(),n.Ub(10,"mat-dialog-actions",5),n.Ub(11,"button",6),n.bc("click",function(){return e.onNoClick()}),n.Kc(12,"Annuler"),n.Tb(),n.Ub(13,"button",7),n.bc("click",function(){return e.onOkClick()}),n.Kc(14,"Ok"),n.Tb(),n.Tb(),n.Tb(),n.Tb()),2&t&&(n.Cb(4),n.Mc("Suppression ",e.model," "))},directives:[s.h,o.a,c.a,s.e,s.c,r.a,s.d],styles:[".mat-dialog-container .mat-dialog-content{padding:0 24px!important}"]}),t})(),l=(()=>{class t{constructor(t){this.dialog=t}openDialog(t){return this.dialog.open(a,{width:"1100px",disableClose:!0,data:{model:t}}).afterClosed()}}return t.\u0275fac=function(e){return new(e||t)(n.Yb(s.b))},t.\u0275prov=n.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},lOAm:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var s=i("ofXK"),n=i("2thQ"),o=i("fXoL");let c=(()=>{class t{}return t.\u0275mod=o.Mb({type:t}),t.\u0275inj=o.Lb({factory:function(e){return new(e||t)},imports:[[s.c,n.a]]}),t})()},rdAd:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var s=i("tk/3"),n=i("LRne"),o=i("fXoL");let c=(()=>{class t{constructor(t,e){this.http=t,this.urlApi=e,this.controller="files"}deleteFiles(t,e){return 0===t.length?Object(n.a)(null):this.http.post(`${this.urlApi}/${this.controller}/deleteFiles/`,{filenames:t,folder:e})}uploadFiles0(t,e){return t?this.http.post(`${this.urlApi}/${this.controller}/uploadFiles/${e}`,t,{headers:new s.f({enctype:"multipart/form-data"}),reportProgress:!0}):Object(n.a)(null)}uploadFiles(t,e){return this.http.request(new s.g("POST",`${this.urlApi}/${this.controller}/uploadFiles/${e}`,t,{reportProgress:!0}))}}return t.\u0275fac=function(e){return new(e||t)(o.Yb(s.b),o.Yb("API_URL"))},t.\u0275prov=o.Kb({token:t,factory:t.\u0275fac}),t})()}}]);