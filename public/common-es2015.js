(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"5WMv":function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var i=s("mrSG"),n=s("XNiG"),r=s("fXoL"),o=s("kZa3"),a=s("LRne");let c=(()=>{class e extends o.a{constructor(){super("files")}deleteFiles(e,t){return 0===e.length?Object(a.a)(null):this.http.post(`${this.urlApi}/${this.controller}/deleteFiles/`,{filenames:e,folder:t},{reportProgress:!0})}uploadFiles(e,t){return e?this.http.post(`${this.urlApi}/${this.controller}/uploadFiles/${t}`,e,{reportProgress:!0}):Object(a.a)(null)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=s("ofXK"),h=s("bTqV"),m=s("NFeN");function f(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",8),r.Wb(1,"img",9,10),r.ec("error",(function(){r.Cc(e);const t=r.Ac(2);return r.ic(2).imgError(t)})),r.Vb(),r.Wb(3,"button",11),r.ec("click",(function(){r.Cc(e);const s=t.$implicit;return r.ic(2).removeFromImages(s.name)})),r.Wb(4,"mat-icon",12),r.Lc(5,"delete_sweep"),r.Vb(),r.Vb(),r.Vb()}if(2&e){const e=t.$implicit;r.Db(1),r.pc("src",e.image,r.Ec)}}function u(e,t){if(1&e){const e=r.Xb();r.Ub(0,5),r.Wb(1,"button",6),r.ec("click",(function(){r.Cc(e);const t=r.ic(),s=r.Ac(2);return t.openInput(s)})),r.Wb(2,"mat-icon"),r.Lc(3,"add"),r.Vb(),r.Lc(4),r.Vb(),r.Lc(5," \xa0\xa0 "),r.Jc(6,f,6,1,"div",7),r.Tb()}if(2&e){const e=r.ic();r.Db(4),r.Nc(" ",e.nameBtn," "),r.Db(2),r.pc("ngForOf",e.Images)}}function p(e,t){if(1&e){const e=r.Xb();r.Wb(0,"div",13),r.Wb(1,"div",14),r.Wb(2,"img",15,10),r.ec("error",(function(){r.Cc(e);const t=r.Ac(3);return r.ic().imgError(t)})),r.Vb(),r.Wb(4,"button",11),r.ec("click",(function(){r.Cc(e);const t=r.ic();return t.remove(t.oneImage)})),r.Wb(5,"mat-icon",12),r.Lc(6,"delete_sweep"),r.Vb(),r.Vb(),r.Vb(),r.Wb(7,"button",6),r.ec("click",(function(){r.Cc(e);const t=r.ic(),s=r.Ac(2);return t.openInput(s)})),r.Wb(8,"mat-icon"),r.Lc(9,"add"),r.Vb(),r.Lc(10),r.Vb(),r.Rb(11,"div",16),r.Vb()}if(2&e){const e=r.ic();r.Db(2),r.pc("src",e.oneImage,r.Ec),r.Db(8),r.Nc(" ",e.nameBtn," ")}}let d=(()=>{class e{constructor(e,t){this.filesService=e,this.url=t,this.listOfNames=[],this.imagesToShow=[],this.listToDelete=[],this.files=[],this.nameBtn="",this.folderToSaveInServer="folder",this.multiple=!1,this.oneImage="assets/404.jpg",this.Images=[],this.propertyOfParent=new n.a,this.eventSubmitToParent=new n.a,this.eventSubmitFromParent=new n.a}ngOnInit(){this.propertyOfParent.subscribe(e=>{if(!e)return;const t=e.split(";");if(t.pop(),this.listOfNames=t,this.listToDelete=[],this.multiple)t.forEach((e,t)=>{const s=e;if(null!==s&&s.startsWith("http"))this.Images[t]={name:s,image:s};else if(s){const e=`${this.url}/${this.folderToSaveInServer.replace("_","/")}/${s}`;this.Images[t]={name:e,image:e}}else this.Images[t]={name:"assets/404.jpg",image:"assets/404.jpg"}});else{const s=0!==t.length?t[0]:e;this.oneImage=null!==s&&s.startsWith("http")?s:s?`${this.url}/${this.folderToSaveInServer.replace("_","/")}/${s}`:"assets/404.jpg"}}),this.eventSubmitFromParent.subscribe(e=>Object(i.b)(this,void 0,void 0,(function*(){yield this.submit(e)})))}upload(e){if(this.multiple)for(let t=0;t<e.length;t++){const s=e.item(t);this.listOfNames.push(this.setFileName(s)),this.sendPropertyOfParent(),this.files.push(s),this.files.forEach((e,t)=>{const s=new FileReader;s.onload=()=>{-1===this.Images.findIndex(t=>this.setFileName(e).includes(t.name))&&this.Images.push({name:this.setFileName(e),image:s.result.toString()})},s.readAsDataURL(e)})}else{const t=e.item(0);this.listOfNames=[],this.listOfNames.push(this.setFileName(t)),this.sendPropertyOfParent(),this.files=[],this.files.push(t),this.handleFileInput(t)}}fileToImageFrom(){}handleFileInput(e){const t=new FileReader;t.onload=()=>this.oneImage=t.result.toString(),t.readAsDataURL(e)}imgError(e){e.src="assets/404.jpg"}setIcon(e){const t=e.lastIndexOf("."),s=e.substring(t+1);return"pdf"===s||"pdf;"===s?"assets/svg/pdf.svg":"assets/svg/word.svg"}removeFromImages(e){const t=this.Images.findIndex(t=>e.includes(t.name));this.Images.splice(t,1);const s=this.listOfNames.findIndex(t=>e.includes(t));this.listToDelete.push(this.listOfNames[s]),-1!==s&&(this.listOfNames.splice(s,1),this.sendPropertyOfParent());const i=e.indexOf("_"),n=e.substring(i);-1!==this.files.findIndex(e=>e.name===n)&&this.files.splice(s,1)}remove(e){const t=this.listOfNames.findIndex(t=>e.includes(t));this.listToDelete.push(this.listOfNames[t]),-1!==t&&(this.listOfNames.splice(t,1),this.sendPropertyOfParent());const s=e.indexOf("_"),i=e.substring(s);-1!==this.files.findIndex(e=>e.name===i)&&this.files.splice(t,1),this.oneImage="assets/404.jpg"}openInput(e){e.click()}sendPropertyOfParent(){let e="";this.listOfNames.forEach(t=>{e+=t+";"}),this.eventSubmitToParent.next(e)}submit(e){return Object(i.b)(this,void 0,void 0,(function*(){const t=new FormData;if(this.files.forEach(e=>{const s=this.setFileName(e);t.append("file",e,s),console.log(e)}),t){e.id&&!this.folderToSaveInServer.includes("_")&&(this.folderToSaveInServer=`${this.folderToSaveInServer}_${e.id}`);const s=yield this.filesService.uploadFiles(t,this.folderToSaveInServer).toPromise(),i=yield this.filesService.deleteFiles(this.listToDelete,this.folderToSaveInServer).toPromise();console.log(this.folderToSaveInServer,s,i)}}))}setFileName(e){return`${e.lastModified}_${e.name}`}}return e.\u0275fac=function(t){return new(t||e)(r.Qb(c),r.Qb("BASE_URL"))},e.\u0275cmp=r.Kb({type:e,selectors:[["app-upload-image"]],inputs:{nameBtn:"nameBtn",folderToSaveInServer:"folderToSaveInServer",multiple:"multiple",propertyOfParent:"propertyOfParent",eventSubmitToParent:"eventSubmitToParent",eventSubmitFromParent:"eventSubmitFromParent"},decls:6,vars:2,consts:[[1,"d-flex","mb-3","align-items-center"],["hidden","","multiple","","accept","image/*","type","file",3,"change"],["file1",""],["class","ml-3",4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"ml-3"],["mat-raised-button","","type","button","color","accent",2,"height","fit-content",3,"click"],["style","font-size: .7em;margin: 0;",4,"ngFor","ngForOf"],[2,"font-size",".7em","margin","0"],[2,"width","70px","height","70px",3,"src","error"],["img",""],["mat-icon-button","","color","warn","type","button",3,"click"],[2,"font-size","1.3em !important"],[1,"row","align-items-center","justify-content-center"],[1,"col-md-12","mb-2"],[2,"width","170px","height","170px",3,"src","error"],[1,"col-md-12"]],template:function(e,t){if(1&e&&(r.Wb(0,"div",0),r.Wb(1,"input",1,2),r.ec("change",(function(e){return t.upload(e.target.files)})),r.Vb(),r.Jc(3,u,7,2,"ng-container",3),r.Jc(4,p,12,2,"ng-template",null,4,r.Kc),r.Vb()),2&e){const e=r.Ac(5);r.Db(3),r.pc("ngIf",t.multiple)("ngIfElse",e)}},directives:[l.n,h.a,m.a,l.m],styles:["img[_ngcontent-%COMP%]{height:20px}"]}),e})()},J3i2:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s("2Vo4"),n=s("fXoL"),r=s("sYmb");let o=(()=>{class e{constructor(e){this.translate=e,this.lang=new i.a(this.translate.currentLang),this.langSync="fr",this.isFr=!0}init(){const e=localStorage.getItem("lang")||"fr";this.changeLanguage(e)}changeLanguage(e){this.translate.setDefaultLang(e),this.translate.use(e),localStorage.setItem("lang",e),this.langSync=e,this.isFr="fr"===this.langSync}currentLang(){return this.translate.onLangChange}get(e){return this.translate.instant(e)}getObs(e){return this.translate.stream(e)}}return e.\u0275fac=function(t){return new(t||e)(n.ac(r.d))},e.\u0275prov=n.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);