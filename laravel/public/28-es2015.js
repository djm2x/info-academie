(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{Yj9t:function(e,t,r){"use strict";r.r(t),r.d(t,"AuthModule",function(){return N});var o=r("ofXK"),i=r("tyNb"),s=r("mrSG"),a=r("3Pt+"),n=r("V2kc"),c=r("fXoL"),l=r("7q3A"),m=r("M0ag"),b=r("0kbX"),d=r("Wp6s"),u=r("r3Nu"),h=r("kmnG"),p=r("qFsG"),f=r("NFeN"),g=r("bTqV");function w(e,t){1&e&&(c.Ub(0,"mat-error"),c.Mc(1,"Email non valide"),c.Tb())}const v=function(){return["/auth/create"]};let k=(()=>{class e{constructor(e,t,r,o,i,s,a){this.fb=e,this.uow=t,this.router=r,this.session=o,this.route=i,this.snackBar=s,this.url=a,this.o=new n.r,this.hide=!0,this.profil=!0,this.code=""}ngOnInit(){return Object(s.a)(this,void 0,void 0,function*(){this.o.email=(this.profil?"prof":"student")+"@angular.io",this.o.password="123",this.createForm(),this.code=this.route.snapshot.paramMap.get("code"),this.code&&""!==this.code&&this.submitCodeCommingFromEmail()})}changeProfil(){this.profil=!this.profil,this.myForm.get("email").setValue(this.profil?"prof@angular.io":"student@angular.io")}createForm(){this.myForm=this.fb.group({email:[this.o.email,[a.u.required,a.u.email]],password:[this.o.password,[a.u.required]]})}get email(){return this.myForm.get("email")}get password(){return this.myForm.get("password")}get emailError(){return this.email.hasError("required")?"You must enter a value":this.email.hasError("email")?"Not a valid email":""}get passwordError(){return this.password.hasError("required")?"You must enter a value":""}submit(e){this.uow.accounts.login(e).subscribe(e=>{if(e.code<0)this.snackBar.notifyAlert(400,e.message);else{this.snackBar.notifyOk(200,e.message),this.session.doSignIn(e.user,e.child,e.niveau,e.branche,e.token);const t=localStorage.getItem("route");this.router.navigate([t&&"/"!==t?t:"/admin"])}})}submitCodeCommingFromEmail(){this.uow.accounts.activeAccount(this.code).subscribe(e=>{e.code<=0?this.snackBar.notifyAlert(400,e.message):(this.snackBar.notifyOk(200,e.message),this.session.doSignIn(e.user,e.child,null,null,e.token),this.router.navigate(["/admin"]))})}resetForm(){this.o=new n.r,this.createForm()}ngOnDestroy(){console.log("ngOnDestroy")}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.e),c.Ob(l.a),c.Ob(i.e),c.Ob(m.a),c.Ob(i.a),c.Ob(b.a),c.Ob("BASE_URL"))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-login"]],decls:35,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center","m-0","pl-2","pr-2",2,"height","100vh"],[1,"mat-elevation-z8"],[1,"d-flex","justify-content-between","align-items-center"],[1,"col-md-7"],["src","assets/login.png","alt","","srcset","",2,"width","100%"],[1,"col-md-5"],[3,"formGroup","ngSubmit"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],["src","assets/icon.png","alt","logo",1,"mb-4","mt-3",2,"height","200px"],[2,"text-align","center","color","var(--primary)","font-weight","bold"],[1,""],["appearance","fill",1,"col-md-12","p-0"],["matInput","","formControlName","email","placeholder","Email address"],[4,"ngIf"],["appearance","fill",1,"col-md-12","p-0","mb-4"],["matInput","","formControlName","password","placeholder","Mot de passe",3,"type"],["matSuffix","",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"col-md-12","mb-2",3,"disabled"],["mat-raised-button","","color","accent","type","button",1,"col-md-12",3,"routerLink"],["target","_blank","rel","noopener noreferrer",1,"mt-3","mat-raised-button","mat-button-base",3,"href"],[1,"d-flex","flex-row-reverse","mt-2","mb-2"],[2,"cursor","pointer",3,"click"]],template:function(e,t){1&e&&(c.Ub(0,"div",0),c.Ub(1,"mat-card",1),c.Pb(2,"app-theme"),c.Ub(3,"div",2),c.Ub(4,"div",3),c.Pb(5,"img",4),c.Tb(),c.Ub(6,"div",5),c.Ub(7,"form",6),c.bc("ngSubmit",function(){return t.submit(t.myForm.value)}),c.Ub(8,"div",7),c.Pb(9,"img",8),c.Ub(10,"h2",9),c.Mc(11,"Info-academie"),c.Tb(),c.Ub(12,"div",10),c.Ub(13,"mat-form-field",11),c.Ub(14,"mat-label"),c.Mc(15,"Email"),c.Tb(),c.Pb(16,"input",12),c.Kc(17,w,2,0,"mat-error",13),c.Tb(),c.Ub(18,"mat-form-field",14),c.Ub(19,"mat-label"),c.Mc(20,"Mot de passe"),c.Tb(),c.Pb(21,"input",15),c.Ub(22,"mat-icon",16),c.bc("click",function(){return t.hide=!t.hide}),c.Mc(23),c.Tb(),c.Tb(),c.Ub(24,"button",17),c.Mc(25,"Connexion"),c.Tb(),c.Ub(26,"button",18),c.Mc(27,"Inscription"),c.Tb(),c.Ub(28,"a",19),c.Mc(29," Vers le site "),c.Tb(),c.Ub(30,"div",20),c.Ub(31,"span",21),c.bc("click",function(){return t.changeProfil()}),c.Mc(32," teste avec un "),c.Ub(33,"b"),c.Mc(34),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e&&(c.Cb(7),c.mc("formGroup",t.myForm),c.Cb(10),c.mc("ngIf",t.myForm.get("email").invalid),c.Cb(4),c.mc("type",t.hide?"password":"text"),c.Cb(2),c.Oc("",t.hide?"visibility_off":"visibility"," "),c.Cb(1),c.mc("disabled",t.myForm.invalid),c.Cb(2),c.mc("routerLink",c.oc(8,v)),c.Cb(2),c.mc("href",t.url,c.Dc),c.Cb(6),c.Nc(t.profil?"Student":"Prof"))},directives:[d.a,u.a,a.v,a.p,a.i,h.c,h.f,p.b,a.c,a.o,a.h,o.n,f.a,h.g,g.a,i.f,h.b],styles:["@media screen and (min-width:600px){.mywith[_ngcontent-%COMP%]{width:35rem}}"]}),e})(),y=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Ib({type:e,selectors:[["app-auth"]],decls:2,vars:0,consts:[[1,"container"]],template:function(e,t){1&e&&(c.Ub(0,"div",0),c.Pb(1,"router-outlet"),c.Tb())},directives:[i.i],styles:[".row[_ngcontent-%COMP%]{background-size:cover;background-repeat:no-repeat;background-position:50%;height:100vh;width:100vw}@media screen and (min-width:600px){.mywith[_ngcontent-%COMP%]{width:35rem}}"]}),e})();function C(e,t){1&e&&(c.Ub(0,"mat-error"),c.Mc(1,"Email non valide"),c.Tb())}function E(e,t){if(1&e&&(c.Ub(0,"mat-error"),c.Mc(1),c.Tb()),2&e){const e=c.fc(2);c.Cb(1),c.Nc(e.passwordError)}}function T(e,t){if(1&e){const e=c.Vb();c.Ub(0,"mat-form-field",3),c.Ub(1,"mat-label"),c.Mc(2,"Mot de passe"),c.Tb(),c.Pb(3,"input",12),c.Ub(4,"mat-icon",13),c.bc("click",function(){c.Bc(e);const t=c.fc();return t.hide=!t.hide}),c.Mc(5),c.Tb(),c.Kc(6,E,2,1,"mat-error",5),c.Tb()}if(2&e){const e=c.fc();c.Cb(3),c.mc("type",e.hide?"password":"text"),c.Cb(2),c.Oc("",e.hide?"visibility_off":"visibility"," "),c.Cb(1),c.mc("ngIf",e.passwordError)}}function U(e,t){if(1&e&&(c.Ub(0,"mat-error"),c.Mc(1),c.Tb()),2&e){const e=c.fc(2);c.Cb(1),c.Nc(e.checkPasswordError)}}function M(e,t){if(1&e){const e=c.Vb();c.Ub(0,"mat-form-field",14),c.Ub(1,"mat-label"),c.Mc(2,"R\xe9p\xe9ter le mot de pass"),c.Tb(),c.Pb(3,"input",15),c.Ub(4,"mat-icon",13),c.bc("click",function(){c.Bc(e);const t=c.fc();return t.hide2=!t.hide2}),c.Mc(5),c.Tb(),c.Kc(6,U,2,1,"mat-error",5),c.Tb()}if(2&e){const e=c.fc();c.Cb(3),c.mc("formControl",e.checkPassword)("type",e.hide2?"password":"text"),c.Cb(2),c.Oc("",e.hide2?"visibility_off":"visibility"," "),c.Cb(1),c.mc("ngIf",e.checkPassword.touched&&e.checkPasswordError)}}const P=function(){return["/auth/create"]},I=function(){return["/auth/login"]};let O=(()=>{class e{constructor(e,t,r,o,i,s){this.fb=e,this.uow=t,this.router=r,this.session=o,this.route=i,this.snackBar=s,this.o=new n.r,this.code="",this.hide=!0,this.hide2=!0,this.checkPassword=new a.f("",[a.u.required]),this.isEmailChecked=!1}ngOnInit(){if(this.code=this.route.snapshot.paramMap.get("code"),this.code){const e=atob(this.code).split("*"),[t,r,o]=e;this.o.email=t,this.isEmailChecked=!0}this.createForm()}createForm(){this.myForm=this.fb.group({email:[this.o.email,[a.u.required,a.u.email]],password:[this.o.password,this.isEmailChecked?[a.u.required]:[]]})}get email(){return this.myForm.get("email")}get password(){return this.myForm.get("password")}get emailError(){return this.email.hasError("required")?"You must enter a value":this.email.hasError("email")?"Not a valid email":""}get passwordError(){return this.password.hasError("required")?"You must enter a value":""}get checkPasswordError(){return this.checkPassword.hasError("required")?"You must enter a value":this.checkPassword.value!==this.password.value?"les mot de pass sont pas les m\xeame":""}sendEmailForResetPassword(e){return Object(s.a)(this,void 0,void 0,function*(){this.uow.accounts.sendEmailForResetPassword(e,"auth%2Freset","fr").subscribe(e=>{-1===e.code?(console.log(e.message),this.snackBar.notifyAlert(400,e.message)):(console.log(e.message),this.snackBar.notifyOk(200,e.message),this.router.navigate(["/auth/login"]))},e=>{console.log(e.error)})})}resetPassword(e){this.uow.accounts.resetPassword({email:this.o.email,password:e}).subscribe(e=>{-1===e.code?console.log("Email Incorrect"):1===e.code&&(console.log(e.message),this.router.navigate(["/auth/login"]))},e=>{console.log(e.error)})}}return e.\u0275fac=function(t){return new(t||e)(c.Ob(a.e),c.Ob(l.a),c.Ob(i.e),c.Ob(m.a),c.Ob(i.a),c.Ob(b.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-reset"]],decls:19,vars:9,consts:[[3,"formGroup"],[1,"d-flex","flex-column","justify-content-center","align-items-center"],[1,""],["appearance","fill",1,"col-md-12","p-0"],["matInput","","formControlName","email","placeholder","Email address","[]","isEmailChecked"],[4,"ngIf"],["appearance","fill","class","col-md-12 p-0",4,"ngIf"],["appearance","fill","class","col-md-12 p-0 mb-4",4,"ngIf"],["mat-raised-button","","color","primary",1,"col-md-12","mb-2",3,"disabled","click"],["mat-raised-button","","color","accent","type","button",1,"col-md-12",3,"routerLink"],[1,"d-flex","flex-row-reverse","mt-2","mb-2","text-muted"],[2,"cursor","pointer",3,"routerLink"],["matInput","","formControlName","password","placeholder","Mot de passe",3,"type"],["matSuffix","",3,"click"],["appearance","fill",1,"col-md-12","p-0","mb-4"],["matInput","","placeholder","R\xe9p\xe9ter le mot de pass",3,"formControl","type"]],template:function(e,t){1&e&&(c.Ub(0,"form",0),c.Ub(1,"mat-card-content",1),c.Ub(2,"h3"),c.Mc(3,"VEUILLEZ SAISIR VOTRE ADRESSE EMAIL"),c.Tb(),c.Ub(4,"div",2),c.Ub(5,"mat-form-field",3),c.Ub(6,"mat-label"),c.Mc(7,"Email"),c.Tb(),c.Pb(8,"input",4),c.Kc(9,C,2,0,"mat-error",5),c.Tb(),c.Kc(10,T,7,3,"mat-form-field",6),c.Kc(11,M,7,4,"mat-form-field",7),c.Ub(12,"button",8),c.bc("click",function(){return t.isEmailChecked?t.resetPassword(t.checkPassword.value):t.sendEmailForResetPassword(t.email.value)}),c.Mc(13," R\xe9initialiser "),c.Tb(),c.Ub(14,"button",9),c.Mc(15," Inscription "),c.Tb(),c.Ub(16,"div",10),c.Ub(17,"span",11),c.Mc(18,"Connexion ?"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e&&(c.mc("formGroup",t.myForm),c.Cb(9),c.mc("ngIf",t.emailError),c.Cb(1),c.mc("ngIf",t.isEmailChecked),c.Cb(1),c.mc("ngIf",t.isEmailChecked),c.Cb(1),c.mc("disabled",t.myForm.invalid||t.isEmailChecked&&""!==t.checkPasswordError),c.Cb(2),c.mc("routerLink",c.oc(7,P)),c.Cb(3),c.mc("routerLink",c.oc(8,I)))},directives:[a.v,a.p,a.i,d.c,h.c,h.f,p.b,a.c,a.o,a.h,o.n,g.a,i.f,h.b,f.a,h.g,a.g],styles:[""]}),e})();const F=[{path:"",redirectTo:"",pathMatch:"full"},{path:"",component:y,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login/:code",component:k},{path:"login",component:k},{path:"create",loadChildren:()=>Promise.all([r.e(0),r.e(29)]).then(r.bind(null,"pUgZ")).then(e=>e.CreateModule),data:{animation:"create"}},{path:"reset/:code",component:O},{path:"reset",component:O}]}];let x=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[i.h.forChild(F)],i.h]}),e})();var S=r("tk/3"),q=r("2thQ"),L=r("sYmb");let N=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(t){return new(t||e)},imports:[[o.c,x,a.j,a.s,S.d,q.a,L.b,u.b]]}),e})()}}]);